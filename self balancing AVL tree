/* Node is defined as :
typedef struct node
{
    int val;
    struct node* left;
    struct node* right;
    int ht;
} node; */
#include<queue>
int h(node * root) //getting height
{
    if(root==NULL)
        return -1;
    else
    {
        int hl=h(root->left);
        int hr=h(root->right);
        return max(hl,hr)+1;
    }
}
node * getnew(int v)// for getting new node
{
    node * newn=new node();
    newn->val=v;
    newn->left=NULL;
    newn->right=NULL;
    newn->ht=0;
    return newn;
}
void ino(node * root)// just an inorder traversal
{
    if(root==NULL)
    {
        return;
    }
    else
    {
        ino(root->left);
        cout<<root->val<<" ";
        ino(root->right);
    }
}

int getBalance(node *Nod)//to get balance factor
{
    if (Nod == NULL)
        return 0;
    return h(Nod->left) - h(Nod->right);
}


node * rightr(node * root)//actually left to right rotation
{
    node * temp=root->left;
    node * temp1=temp->right;
    
    temp->right=root;
    root->left=temp1;
    root->ht=max(h(root->left),h(root->right))+1;
    temp->ht=max(h(temp->left),h(temp->right))+1;
    return temp;
}
node * leftr(node * root) //actually right to left rotation
{
    node * temp=root->right;
    node * temp1=temp->left;
    
    temp->left=root;
    root->right=temp1;
    root->ht=max(h(root->left),h(root->right))+1;
    temp->ht=max(h(temp->left),h(temp->right))+1;
    return temp;
}

node * insert(node * root,int val)
{
    if(root==NULL)
        root=getnew(val);
    else
    {
        if(root->val>val)
            root->left=insert(root->left,val);
        else
            root->right=insert(root->right,val);
    }
    node * temp=root;
    queue<node *> q;
    q.push(temp);
    while(!q.empty())
    {
        node * curr=q.front();
        curr->ht=h(curr);
        if(curr->left!=NULL)
            q.push(curr->left);
        if(curr->right!=NULL)
            q.push(curr->right);
        q.pop();
    }
    
    root->ht = 1 + max(h(root->left), h(root->right));

    //Get the balance factor of parent node
    int balance = getBalance(root);
    //left left case
    if (balance > 1 && val < root->left->val)
        return rightr(root);

    // Right Right Case
    if (balance < -1 && val > root->right->val)
        return leftr(root);

    // Left Right Case
    if (balance > 1 && val > root->left->val)
    {
        root->left = leftr(root->left);
        return rightr(root);
    }

    // Right Left Case
    if (balance < -1 && val < root->right->val)
    {
        root->right = rightr(root->right);
        return leftr(root);
    }
    
  return root;
}

